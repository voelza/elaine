var he=Object.defineProperty;var de=(m,h,v)=>h in m?he(m,h,{enumerable:!0,configurable:!0,writable:!0,value:v}):m[h]=v;var a=(m,h,v)=>(de(m,typeof h!="symbol"?h+"":h,v),v);(function(m,h){typeof exports=="object"&&typeof module!="undefined"?h(exports):typeof define=="function"&&define.amd?define(["exports"],h):(m=typeof globalThis!="undefined"?globalThis:m||self,h(m.ELAINE={}))})(this,function(m){"use strict";const h="@@",v="++",p="~",O="!++",pt="##",bt=s=>new RegExp(h+"{"+s.replaceAll(/[.*+?^${}()|[\]\\]/g,"\\$&")+"}","g"),gt=s=>new RegExp(h+s.replaceAll(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),y=new RegExp(h+"([!]?[a-zA-Z0-9\\(@@\\)_$.,\\s~\\|']+)","g"),Q=new RegExp(h+`\\{([!]?[a-zA-Z0-9\\(@@\\)_$.,\\s~\\|'"]+)\\}`,"g"),vt=new RegExp(h+"\\{(\\{.+\\})\\}","g"),yt=new RegExp("(.+) in (.+)","g"),Nt="|";function E(s,t){if(!t)return t;if(t instanceof Object){let e=t,n=s.indexOf(".");return n!==-1&&(s=s.substring(n+1),e=e.getValueForKeyPath(s)),e}else return t}function P(s){let t=s,e=t.indexOf(".");return e!==-1&&(t=t.substring(0,e)),t}function j(s){let t=s,e=t.indexOf(".");return e!==-1&&(t=t.substring(e+1)),t}class B{constructor(t,e){a(this,"bindingsMap");a(this,"parseTokens");this.bindingsMap=new Map;const n=[];for(const i of t.split(" ").filter(o=>o)){let o=i;if(o.startsWith("!")&&o!=="!="&&(o=o.substring(1),n.push("!")),n.push(o),o.startsWith(h)){const r=o.substring(h.length),u=e.find(l=>l.binding===r);u&&this.bindingsMap.set(r,u)}}this.parseTokens=n}getBindings(){return Array.from(this.bindingsMap.values())}eval(){var r;const t=[];for(const u of this.parseTokens)if(u.startsWith(h)){const l=u.substring(h.length),c=this.bindingsMap.get(l);c&&t.push(E(l,(r=c.state)==null?void 0:r.value))}else t.push(u);let e=[],n=0;for(;n<t.length;){const u=t[n];if(u==="!"){const l=t[n+1];e.push(!l),n=n+2}else if(u==="&&")e.push("&&"),n=n+1;else if(u==="||")e.push("||"),n=n+1;else{const l=t[n+1];if(this.isOperator(l)){const c=t[n+2];e.push(this.evalCondition(u,l,c)),n=n+3}else e.push(u),n=n+1}}let i=e[0],o=1;for(;o<e.length;){let u=e[o];if(u==="&&"){const l=e[o+1];l!=null&&(i=i&&l,o+=2)}else if(u==="||"){const l=e[o+1];l!=null&&(i=i||l,o+=2)}else o++}return i}isOperator(t){return t==="<"||t==="<="||t===">"||t===">="||t==="=="||t==="!="||t==="!=="||t==="==="}parseValue(t){return t==="null"?null:t==="undefined"?void 0:t}evalCondition(t,e,n){let i=this.parseValue(t),o=this.parseValue(n);return e==="<"?i<o:e==="<="?i<=o:e===">"?i>o:e===">="?i>=o:e==="=="?i instanceof Object&&o instanceof Object?JSON.stringify(i)==JSON.stringify(o):i==o:e==="==="?i instanceof Object&&o instanceof Object?JSON.stringify(i)===JSON.stringify(o):i===o:e==="!="?i instanceof Object&&o instanceof Object?JSON.stringify(i)!=JSON.stringify(o):i!=o:e==="!=="?i instanceof Object&&o instanceof Object?JSON.stringify(i)!==JSON.stringify(o):i!==o:!1}}class L{constructor(t){a(this,"_value");a(this,"subscribers",[]);this._value=t,this._value instanceof Array?this._value=new Proxy(this._value,{get:(e,n,i)=>{const o=Reflect.get(e,n,i);return n==="push"||n==="shift"||n==="unshift"||n==="pop"||n==="sort"?(...r)=>{e[n](...r),this.notify()}:n==="splice"?(r,u)=>{e[n](r,u),this.notify()}:o}}):this._value instanceof Object&&(this._value=new Proxy(this._value,{set:(e,n,i,o)=>{const r=Reflect.set(e,n,i,o);return this.notify(),r}}))}set value(t){this.set(t)}get value(){return this._value}set(t){this._value!==t&&(this._value=t,this.notify())}setPathValue(t,e){this._value.setValueForKeyPath(t,e),this.notify()}subscribe(t){this.subscribers.push(t)}unsubscribe(t){const e=this.subscribers.indexOf(t);e!==-1&&this.subscribers.splice(e,1)}notify(){for(const t of this.subscribers)t.update()}}class g{constructor(t){a(this,"value");a(this,"subscribers",[]);this.value=t}set(){}setPathValue(){}subscribe(t){this.subscribers.push(t)}unsubscribe(t){const e=this.subscribers.indexOf(t);e!==-1&&this.subscribers.splice(e,1)}notify(){}}class N{constructor(t,e){a(this,"value");a(this,"computer");a(this,"parents",[]);a(this,"subscribers",[]);this.computer=t,this.value=this.computer(),this.parents=e}init(){}update(){this.value=this.computer(),this.notify()}destroy(){for(const t of this.parents)t.unsubscribe(this)}notify(){for(const t of this.subscribers)t.update()}notifyParents(){for(const t of this.parents)t.notify()}set(){}setPathValue(){}subscribe(t){this.subscribers.push(t)}unsubscribe(t){const e=this.subscribers.indexOf(t);e!==-1&&this.subscribers.splice(e,1)}}function D(s,t){const e=t.parentElement;if(!e)return;const n=t.nextSibling;e.insertBefore(s,n)}function R(s,t){const e=t.parentElement;!e||e.insertBefore(s,t)}class Y extends g{}class _{constructor(t){a(this,"bindings",[]);this.bindings=t}bind(t){var n;const e=this.bindings.reduce((i,o)=>(i.find(r=>r.stateName===o.stateName)===void 0&&i.push(o),i),[]);for(const i of e)(n=i.state)==null||n.subscribe(t)}}class St extends _{constructor(t,e){super(t);a(this,"conditionalBindings",[]);this.conditionalBindings=e}init(){this.update()}update(){for(const t of this.conditionalBindings)t.condition.eval()?t.value.init():t.value.destroy()}destroy(){for(const t of this.conditionalBindings)t.value.destroy()}}function Et(s,t){const e=[];for(const n of s.split(";")){const i=n.split(":"),o=i[0].trim(),r=new B(o,t),u=i[1].trim();e.push({condition:r,value:u,stateBindings:[]})}return e}function At(s,t){const e=[];for(const n of t.split(";")){const i=n.split(":"),o=i[0].trim(),r=A(s,y,o),u=new B(o,r),l=i[1].trim();e.push({condition:u,stateBindings:r,value:l})}return e}class Lt extends _{constructor(t,e,n,i){super(e);a(this,"element");a(this,"eventName");a(this,"listener");var o;this.bind(this),this.element=t,this.eventName=n,this.listener=r=>{var l;const u=[];for(const c of e)u.push(E(c.binding,(l=c.state)==null?void 0:l.value));return u.push(r),i(...u)},(o=this.element)==null||o.removeAttribute(v+this.eventName),this.immediateInitNeeded()&&this.init()}immediateInitNeeded(){return this.bindings.length===0||this.bindings.filter(t=>t.state instanceof Y).length===this.bindings.length}init(){var t;(t=this.element)==null||t.addEventListener(this.eventName,this.listener)}update(){}destroy(){var t;(t=this.element)==null||t.removeEventListener(this.eventName,this.listener)}}function Tt(s,t){const e=[];let n=s;const i=n.indexOf("(");if(i!==-1){n=s.substring(0,i);const o=s.substring(i+1,s.length-1).split(",").map(r=>r.trim());for(const r of o){const u=r.replace(h,"");let l,c;if(r.startsWith(h))l=P(u),c=l.startsWith(p)?t.parent.getState(l.substring(p.length)):t.getState(l);else{l=u;let d=u;if(l.startsWith(Nt)){const f=u.replace(/\|/,"{").replace(/\|/,"}").replace(/~/g,":").replaceAll(/(')([\s]+)(')/g,"$1,$3").replaceAll(/'/g,'"');d=JSON.parse(f)}c=new Y(d)}e.push({binding:u,stateName:l,stateSubPath:j(u),state:c})}}return{name:n,params:e}}function T(s,t,e,n){const i=Tt(n,s),o=i.name,r=i.params,u=s.getMethod(o);if(u)return new Lt(t,r,e,u)}function wt(s,t,e,n){const i=At(s,n.substring(1,n.length-1)),o=[];for(const u of i){const l=T(s,t,e,u.value);l&&o.push({condition:u.condition,stateBindings:u.stateBindings,value:l})}const r=[];for(const u of o){const l=u.stateBindings;if(l)for(const d of l)r.push(d);const c=u.value;for(const d of c.bindings)r.find(f=>f.binding===d.binding)===void 0&&r.push(d)}s.addLink(new St(r,o))}function tt(s,t,e,n=void 0){const i=e.name.substring(h.length),o=e.value;if(o.startsWith("{")&&o.endsWith("}"))wt(s,t,i,o);else return o.startsWith(O)&&n!==void 0?T(n,t,i,o.substring(O.length)):T(s,t,i,o)}function et(s,t,e=0){const n=[];let i=s.exec(t);for(;i!==null;)n.push(i[e]),i=s.exec(t);return n}function xt(s,t,e=1){return et(s,t,e).map(i=>{const o=i.trim(),r=P(o).trim(),u=j(o).trim();return{binding:o,stateName:r,stateSubPath:u}})}function Ct(s,t,e=[0]){const n=[];let i=s.exec(t);for(;i!==null;){const o=[];for(const r of e){const u=i[r];u&&o.push({group:r,value:u})}n.push({matches:o}),i=s.exec(t)}return n}function A(s,t,e,n=1){return xt(t,e,n).filter(i=>{const o=i.stateName,r=s.getState(o);if(r)return i.state=r,!0;const u=o.substring(0,o.indexOf("(")).trim();if(!s.getMethod(u))return!1;const c=T(s,void 0,"",i.binding);if(!c)return!1;const d=[];for(const b of c.bindings)b.state&&d.push(b.state);const f=new N(()=>c.listener(void 0),d);for(const b of d)b.subscribe(f);return s.addLink(f),i.stateName=u,i.state=f,!0})}function Ot(s,t){if(t.startsWith(h)){const i=t.substring(h.length),o=P(i),r=s.getState(o);if(r)return{computer:()=>E(i,r.value),states:[r]}}const e=t.substring(0,t.indexOf("(")).trim();if(s.getMethod(e)){const i=T(s,void 0,"",t),o=[];for(const r of i.bindings)r.state&&o.push(r.state);return{computer:()=>i.listener(void 0),states:o}}return{computer:()=>t,states:[]}}function nt(s,t){const e=Ot(s,t),n=new N(e.computer,e.states);for(const i of e.states)i.subscribe(n);return s.addLink(n),n}class st extends _{constructor(t,e,n=void 0){super(t);a(this,"template");a(this,"isConditional");a(this,"conditionalBindings",[]);a(this,"valueObjectsToStrConverter");this.bind(this),this.isConditional=e.startsWith("{")&&e.endsWith("}"),this.template=this.isConditional?e.substring(1,e.length-1):e,this.valueObjectsToStrConverter=n,this.isConditional&&(this.conditionalBindings=Et(this.template,t))}init(){this.update()}destroy(){var t;for(const e of this.bindings)(t=e.state)==null||t.unsubscribe(this)}update(){if(this.isConditional){let t="";for(const e of this.conditionalBindings)e.condition.eval()&&(t+=this.applyBindingsToTemplate(e.value)+" ");this.updateBinding(t)}else this.updateBinding(this.applyBindingsToTemplate(this.template))}applyBindingsToTemplate(t){let e=t;for(const n of this.bindings)e=this.updateTemplate(e,n);return e.replaceAll(new RegExp(pt,"g"),"")}updateTemplate(t,e){var u;let n=t;if(!e.binding)return n;const i=this.bindingRegex(e.binding),o=(u=e.state)==null?void 0:u.value,r=E(e.binding,o);return n=n.replaceAll(i,this.valueAsString(r)),n}valueAsString(t){return t instanceof Object?this.valueObjectsToStrConverter?this.valueObjectsToStrConverter(t):JSON.stringify(t):t}bindingRegex(t){return gt(t)}}class Pt extends st{constructor(t,e,n){super(e,n.trim());a(this,"text");this.text=t}bindingRegex(t){return bt(t)}updateBinding(t){this.text.textContent=t}}function W(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){var t=Math.random()*16|0,e=s=="x"?t:t&3|8;return e.toString(16)})}class It{constructor(t,e,n){a(this,"element");a(this,"binding");a(this,"isPathValue");a(this,"inputListener");a(this,"targetAttribute");a(this,"eventListener");this.element=e,this.binding=n,this.isPathValue=n.binding!==n.stateName,this.inputListener=this.getInputListener(n),this.element.removeAttribute(h+"model"),this.targetAttribute=e.getAttribute("type")==="checkbox"?"checked":"value",this.eventListener=this.createInputListener(t)}getInputListener(t){return this.isPathValue?e=>{var i;const n=e.target;n&&((i=t.state)==null||i.setPathValue(t.stateSubPath,n[this.targetAttribute]))}:e=>{const n=e.target;n&&t.state&&(t.state.value=n[this.targetAttribute])}}createInputListener(t){const e=this.binding.binding+"-"+W();return t.addMethod(e,this.inputListener),tt(t,this.element,{name:"++input",value:e})}init(){var t;this.update(),(t=this.eventListener)==null||t.init()}update(){var t,e,n;this.isPathValue?this.element[this.targetAttribute]=(e=(t=this.binding.state)==null?void 0:t.value)==null?void 0:e.getValueForKeyPath(this.binding.stateSubPath):this.element[this.targetAttribute]=(n=this.binding.state)==null?void 0:n.value}destroy(){var t,e;(t=this.eventListener)==null||t.destroy(),(e=this.binding.state)==null||e.unsubscribe(this)}}class Bt extends L{constructor(t,e){super(t);a(this,"list");this.list=e}notify(){super.notify(),this.list instanceof N?this.list.notifyParents():this.list.notify()}}class Rt{constructor(t,e,n,i){a(this,"id",W());a(this,"instance");a(this,"loopValueName");a(this,"binding");a(this,"forComment");a(this,"loopTemplate");a(this,"initDone");a(this,"loopInstances");this.initDone=!1,this.instance=t,this.loopValueName=n,this.binding=i,this.forComment=document.createComment("for-"+this.id),D(this.forComment,e),e.remove(),this.loopTemplate=e.cloneNode(!0),e.removeAttribute(h+"for"),this.loopTemplate.removeAttribute(h+"for"),this.loopInstances=[]}init(){var t;this.initDone||(this.initDone=!0,this.insertLoopChildren(E(this.binding.binding,(t=this.binding.state)==null?void 0:t.value)))}update(){var t;this.resetLoop(),this.insertLoopChildren(E(this.binding.binding,(t=this.binding.state)==null?void 0:t.value))}destroy(){var t;for(const e of this.loopInstances)e.destroy();(t=this.binding.state)==null||t.unsubscribe(this)}resetLoop(){for(const t of this.loopInstances)t.unmount(),t.destroy();this.loopInstances=[]}insertLoopChildren(t){if(!!t)for(let e=t.length-1;e>=0;e--){const n=t[e],i=new I(x.LOOP,this.loopTemplate,this.loopTemplate,this.instance);i.merge(this.instance),i.addState(this.loopValueName,new Bt(n,this.binding.state)),i.addState("_index",new g(e)),i.appendMount(this.forComment),this.loopInstances.push(i)}}}const _t=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","itemscope","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected","truespeed"];class Mt extends st{constructor(t,e,n,i){super(e,i,o=>{if(o instanceof Array)return o.join(" ");let r="";for(const u in o)r+=u+":"+o[u]+";";return r});a(this,"element");a(this,"attribute");a(this,"staticValue");a(this,"isBooleanAttribute");this.element=t,this.attribute=n,this.isBooleanAttribute=_t.includes(this.attribute),this.element.removeAttribute(h+this.attribute),this.staticValue=this.element.getAttribute(this.attribute)}updateBinding(t){this.element.removeAttribute(this.attribute);let e="";this.staticValue!==null&&(e+=this.staticValue,e+=" "),e+=t,(!this.isBooleanAttribute||e==="true")&&(this.element.setAttribute(this.attribute,e),this.attribute==="value"&&(this.element.value=e))}}class it extends _{constructor(t,e,n,i,o=void 0){super(e);a(this,"id",W());a(this,"ifComment");a(this,"element");a(this,"instance");a(this,"condition");a(this,"isElementRendered");this.bind(this),this.condition=n,this.ifComment=document.createComment("if-"+this.id),R(this.ifComment,t),this.element=t,this.element.removeAttribute(h+"if"),this.instance=o!=null?o:new I(x.IF,this.element,this.element).merge(i),this.element.remove()}init(){this.eval()}update(){this.eval()}destroy(){var t;for(const e of this.bindings)(t=e.state)==null||t.unsubscribe(this);this.instance.destroy()}eval(){const t=this.condition.eval();t?(!this.isElementRendered||this.isElementRendered===void 0)&&(this.isElementRendered=t,this.instance.appendMount(this.ifComment)):(this.isElementRendered||this.isElementRendered===void 0)&&(this.isElementRendered=t,this.instance.unmount())}}function $(s,t,e=void 0){if(t.tagName==="SCRIPT"||t instanceof Comment)return;if(t.tagName==="TEMPLATE-STATE"){Ut(s,t);return}if(t.hasAttribute&&t.hasAttribute(lt)){Kt(s,t,e);return}let n=!0;!(t instanceof Text)&&t.hasAttributes()&&(n=Ft(s,t,e)),t instanceof Text&&Vt(s,t),n&&t.hasChildNodes()&&!s.isComponentElement(t.tagName)&&kt(s,t.childNodes,e)}function kt(s,t,e=void 0){for(let n=0;n<t.length;n++){const i=t[n];$(s,i,e)}}function Vt(s,t){const e=t.textContent;if(!e)return;let n=[];const i=et(vt,e,1);let o=e;i.length===1?(o=i[0],n=A(s,y,o)):n=A(s,Q,e),n.length!==0&&s.addLink(new Pt(t,n,o))}function Ft(s,t,e=void 0){let n=!0;for(const i of Array.from(t.attributes))if(i.name===h+"for")jt(s,t,i),n=!1;else if(i.name===h+"model")Dt(s,t,i);else if(i.name===h+"if")Wt(s,t,i),n=!1;else if(i.name.startsWith(h))$t(s,t,i);else if(i.name.startsWith(v))if(s.getComponent(t.tagName)!==void 0)i.value.startsWith(O)&&(i.value=i.value.substring(O.length)),i.value=O+i.value;else{const r=tt(s,t,i,e);r&&s.addLink(r)}return n}function jt(s,t,e){var l,c,d;const n=Ct(yt,e.value,[1,2]);if(n.length!==1)return;const i=n[0].matches,o=(l=i.find(f=>f.group===1))==null?void 0:l.value.trim(),r=(c=i.find(f=>f.group===2))==null?void 0:c.value.trim();if(!o||!r)return;const u=A(s,y,r);if(u.length===1){const f=u[0],b=new Rt(s,t,o,f);(d=f.state)==null||d.subscribe(b),s.addLink(b)}}function Dt(s,t,e){const n=e.value.replaceAll(h,"").trim(),i=n.startsWith(p),o=i?n.substring(p.length):n,r=i?s.parent:s,u=P(o),l=r.getState(u);if(!l)return;const c=j(o),d={binding:o,stateName:u,stateSubPath:c,state:l},f=new It(r,t,d);l.subscribe(f),r.addLink(f)}function Wt(s,t,e){if(s.getComponent(t.tagName))return;const n=e.value,i=A(s,y,n);i.length!==0&&s.addLink(new it(t,i,new B(n,i),s))}function $t(s,t,e){const n=e.name.substring(h.length),i=e.value,o=A(s,y,i);o.length!==0&&s.addLink(new Mt(t,o,n,i))}function Ut(s,t){for(const e of Array.from(t.attributes))s.addState(e.name,nt(s,e.value));t.remove()}function Kt(s,t,e){const n=t.getAttribute(ct),i=nt(s,n);let o=null;for(const u of Array.from(t.children)){const l=u.tagName.toLowerCase();if(l==(i==null?void 0:i.value)){o=u;break}else o===null&&l==="default"&&(o=u);u.remove()}if(!o)throw"Slot-Resolve-Error: Slots with variants must provide a default slot!";const r=Array.from(o.childNodes);for(const u of r)R(u,t),$(s,u,e);t.remove()}class Gt{constructor(){a(this,"listeners",new Map)}dispatchEvent(t,e){var n;for(const i of(n=this.listeners.get(t))!=null?n:[])i(e)}addListener({eventName:t,listener:e}){let n=this.listeners.get(t);n===void 0&&(n=[]),n.push(e),this.listeners.set(t,n)}removeListener({eventName:t,listener:e}){const n=this.listeners.get(t);if(n===void 0)return;n.indexOf(e)!==-1&&n.splice(n.indexOf(e),1)}}var M=new Gt;class Jt{constructor(t){a(this,"notify");this.notify=t}add(t){for(const e of Object.keys(t)){let n=t[e];!(n instanceof L)&&!(n instanceof N)&&!(n instanceof g)&&(n=new g(n)),this["_"+e]=n,Object.defineProperty(this,e,{get:()=>n.value,set:i=>{n.value=i,this.notify()}})}}watch(t,e){const n=this["_"+t];n&&z(()=>{e(n.value)},n)}}function qt(s){return()=>{for(const t of s)t.update()}}class Ht{constructor(){a(this,"_value");a(this,"subscribers");a(this,"triggerNotify");this.subscribers=[],this.triggerNotify=qt(this.subscribers),this._value=new Jt(this.triggerNotify)}set value(t){throw"Not allowed to change Store value"}get value(){return this._value}set(){}setPathValue(){}subscribe(t){this.subscribers.push(t)}unsubscribe(t){const e=this.subscribers.indexOf(t);e!==-1&&this.subscribers.splice(e,1)}notify(){this.triggerNotify()}}var U=new Ht;class ot{constructor(t,...e){a(this,"watcher");a(this,"states");this.watcher=t,this.states=e}init(){}update(){this.watcher()}destroy(){for(const t of this.states)t.unsubscribe(this)}}const rt=[{name:"short",format:{dateStyle:"short",timeStyle:"short"}},{name:"long",format:{dateStyle:"long",timeStyle:"long"}},{name:"medium",format:{dateStyle:"medium",timeStyle:"medium"}},{name:"full",format:{dateStyle:"full",timeStyle:"full"}}],zt=[{name:"int",format:{minFractions:0,maxFractions:0}},{name:"twoDigits",format:{minFractions:2,maxFractions:2}}];let S=new L({dateFormats:rt,translations:{}});function Xt(s){s.dateFormats=[...s.dateFormats||[],...rt],s.numberFormats=[...s.numberFormats||[],...zt],S.value=s}let w=S.value.locale;const K=new Map,G=new Map,J=new Map,at=()=>{w=S.value.locale,K.clear();for(const{name:t,format:e}of S.value.dateFormats||[])K.set(t,e);G.clear();for(const{name:t,format:e}of S.value.numberFormats||[])G.set(t,e);J.clear();const s=S.value.translations[w!=null?w:navigator.language.split("-")[0]];if(s)for(const t of Object.keys(s))J.set(t,s[t])};at();const Zt=new ot(at,S);S.subscribe(Zt);function ut(s,t=void 0){const e=t?K.get(t):void 0;return new Intl.DateTimeFormat(w,{dateStyle:e==null?void 0:e.dateStyle,timeStyle:e==null?void 0:e.timeStyle}).format(s)}function Qt(s,t=void 0){return ut(new Date(s),t)}function Yt(s,t=void 0){const e=t?G.get(t):void 0;return new Intl.NumberFormat(w,{maximumFractionDigits:e==null?void 0:e.maxFractions,minimumFractionDigits:e==null?void 0:e.minFractions}).format(s)}function te(s){const t=J.get(s);return t!=null?t:s}class q{constructor(t){a(this,"value");a(this,"subscribers",[]);this.value=t}set(t){this.value!==t&&(this.value=t)}setPathValue(t,e){this.value.setValueForKeyPath(t,e)}subscribe(t){this.subscribers.push(t)}unsubscribe(t){const e=this.subscribers.indexOf(t);e!==-1&&this.subscribers.splice(e,1)}notify(){for(const t of this.subscribers)t.update()}}var x=(s=>(s[s.SETUP=0]="SETUP",s[s.COMPONENT=1]="COMPONENT",s[s.IF=2]="IF",s[s.LOOP=3]="LOOP",s))(x||{});const lt="elaine-slot",ct="elaine-slot-resolver",ht="elaine-parent-component",H=[];class I{constructor(t,e,n,i=void 0,o=[],r=[],u=void 0,l=void 0){a(this,"origin");a(this,"element");a(this,"parent");a(this,"template");a(this,"states",new Map);a(this,"methods",new Map);a(this,"components",new Map);a(this,"links",[]);a(this,"childInstances",[]);a(this,"condition");a(this,"conditionLink");a(this,"props",[]);a(this,"slots",[]);a(this,"setup");a(this,"onMounted");a(this,"beforeUnmounted");a(this,"onUnmounted");a(this,"beforeDestroyed");a(this,"onDestroyed");a(this,"internalState");a(this,"wasCreated");a(this,"dispatchEvent");a(this,"globalEventListeners",[]);a(this,"dispatchGlobalEvent");a(this,"addGlobalEventListener");a(this,"styleElement");this.origin=t,this.element=e,this.template=n.cloneNode(!0),this.parent=i,this.props=o,this.slots=r,this.setup=u;for(const c of l!=null?l:[])this.components.set(c.name,c);if(this.dispatchEvent=(c,d)=>{const f=new CustomEvent(c,{detail:d});this.template.dispatchEvent(f)},this.dispatchGlobalEvent=(c,d)=>{M.dispatchEvent(c,d)},this.addGlobalEventListener=(c,d)=>{const f={eventName:c,listener:d};M.addListener(f),this.globalEventListeners.push(f)},this.internalState={element:this.template,data:{},methods:{},refs:{},$store:U.value,dispatchEvent:this.dispatchEvent,dispatchGlobalEvent:this.dispatchGlobalEvent,addGlobalEventListener:this.addGlobalEventListener},this.condition=this.extractCondition(e),this.condition&&(this.conditionLink=new it(e,this.condition.getBindings(),this.condition,void 0,this),this.conditionLink.init()),this.wasCreated=!1,this.methods.set("$date",ut),this.methods.set("$strDate",Qt),this.methods.set("$number",Yt),this.methods.set("$t",te),this.states.set("$store",U),this.components.size>0)for(const c of this.components.values()){H.push(c.name);for(const d of c.slots)H.push(d.toUpperCase())}}isComponentElement(t){return H.includes(t)}setupIfNeeded(){if(!this.wasCreated){if(this.resolveProps(this.element,this.parent),this.resolveSetup(),this.resolveSlots(this.element),this.origin===1)for(const t of Array.from(this.element.attributes)){if(t.name.startsWith(ft))continue;const e=t.cloneNode(!0),n=this.template.attributes.getNamedItem(e.name);n&&(e.value+=` ${n.value}`),this.template.attributes.setNamedItem(e)}$(this,this.template,this.parent);for(const t of this.links)t.init();if(this.initComponents([this.template]),this.origin===0){const t=this.gatherAllComponents().map(e=>e.css).filter(e=>e!==void 0).reduce((e,n)=>e+" "+n,"");t&&(this.styleElement=document.createElement("style"),this.styleElement.textContent=t)}this.wasCreated=!0}}gatherAllComponents(){const t=[];for(const e of this.components.values())for(const n of e.gatherAllComponents())t.push(n);return t}addLink(t){this.links.push(t)}getState(t){var o;if(t.startsWith(p))return(o=this.parent)==null?void 0:o.getState(t.substring(p.length));const e=this.states.get(t);if(!t.startsWith("!"))return e;const n=this.states.get(t.substring(1));if(!n)return;const i=new N(()=>!n.value,[n]);return n.subscribe(i),this.states.set(t,i),this.addLink(i),i}addState(t,e){this.states.set(t,e)}merge(t){if(!t)return this;for(const e of t.states.entries())this.states.set(e[0],e[1]);for(const e of t.methods.entries())this.addMethod(e[0],e[1]);for(const e of t.components.entries())this.registerComponent(e[0],e[1]);return this.parent=t.parent,this}getMethod(t){var e;return t.startsWith(p)?(e=this.parent)==null?void 0:e.getMethod(t.substring(p.length)):this.methods.get(t)}addMethod(t,e){this.methods.set(t,e)}registerComponent(t,e){this.components.set(t,e)}getComponent(t){return this.components.get(t)}mount(){this.condition&&!this.condition.eval()||(D(this.template,this.element),this.element.remove(),this.setupIfNeeded(),this.styleElement&&document.body.prepend(this.styleElement),this.onMounted&&this.onMounted(this.internalState))}appendMount(t){this.condition&&!this.condition.eval()||(D(this.template,t),this.setupIfNeeded(),this.onMounted&&this.onMounted(this.internalState))}extractCondition(t){var i;const e=t.getAttribute(h+"if");if(!e)return;const n=A((i=this.parent)!=null?i:this,y,e);return new B(e,n)}resolveSlots(t){var e;for(const n of this.slots){const i=this.template.querySelector(n);if(!i)continue;const o=i.getAttribute("variant"),r=t.querySelector(n);if(r)if(dt(r,(e=this.parent)==null?void 0:e.components),o)r.setAttribute(lt,""),r.setAttribute(ct,o),R(r,i);else for(const u of Array.from(r.childNodes))R(u,i);i.remove()}}resolveProps(t,e){for(const n of this.props){const i=n.name,o=t.getAttribute(i);if(o){const r=o.substring(h.length),u=P(r),l=e==null?void 0:e.getState(u);if(l&&l instanceof L||l instanceof g||l instanceof N||l instanceof q)if(r.indexOf(".")===-1)this.states.set(i,l),this.internalState.data[i]=l;else{const c=new g(E(r,l.value));this.states.set(i,c),this.internalState.data[i]=c}else if(u.indexOf("(")!==-1){const c=u.substring(0,u.indexOf("("));if(e.methods.get(c)){const f=T(e,void 0,"",r),b=[];for(const F of f.bindings)F.state&&b.push(F.state);const V=new N(()=>f.listener(void 0),b);for(const F of b)F.subscribe(V);e.addLink(V),this.states.set(i,V),this.internalState.data[i]=V}}else if(o){const c=new g(this.parseIntoType(n.type,o));this.states.set(i,c),this.internalState.data[i]=l}t.removeAttribute(i)}else{if(n.required||n.required===void 0)throw`Prop-Read-Error: "${i}" is a required prop and was not provided.`;{const r=new g(n.default);this.states.set(i,r),this.internalState.data[i]=n.default}}}}parseIntoType(t,e){return e==="null"?null:e==="undefined"?void 0:t===Number?e.includes(".")?Number.parseFloat(e):Number.parseInt(e):t===Boolean?e==="true":t===Object||t===Array?JSON.parse(e):e}resolveSetup(){var e;if(!this.setup)return;const t=this.setup(this.internalState);if(t){this.onMounted=t.onMounted,this.beforeUnmounted=t.beforeUnmounted,this.onUnmounted=t.onUnmounted,this.beforeDestroyed=t.beforeDestroyed,this.onDestroyed=t.onDestroyed;for(const n in(e=t.state)!=null?e:{}){const i=t.state[n];i instanceof Function?(this.methods.set(n,i),this.internalState.methods[n]=i):i instanceof L||i instanceof N||i instanceof g||i instanceof q?(this.states.set(n,i),this.internalState.data[n]=i):(this.states.set(n,new g(i)),this.internalState.data[n]=i)}}}initComponents(t){var e;for(let n=0;n<t.length;n++){const i=t[n],r=i.getAttribute&&i.getAttribute(ht)!==null?(e=this.parent)==null?void 0:e.getComponent(i.tagName):this.getComponent(i.tagName);if(r!==void 0){const u=r.toInstance(i,this);this.childInstances.push(u);const l=i.getAttribute("ref");l&&(this.internalState.refs[l]=u.internalState),u.condition===void 0&&u.mount();continue}i.hasChildNodes()&&this.initComponents(i.childNodes)}}unmount(){var t;this.beforeUnmounted&&this.beforeUnmounted(this.internalState),this.template.remove(),(t=this.styleElement)==null||t.remove();for(const e of this.childInstances)e.unmount();this.onUnmounted&&this.onUnmounted(this.internalState)}destroy(){var t;this.beforeDestroyed&&this.beforeDestroyed(this.internalState);for(const e of this.childInstances)e.destroy();this.childInstances=[];for(const e of this.links)e.destroy();(t=this.conditionLink)==null||t.destroy();for(const e of this.globalEventListeners)M.removeListener(e);this.globalEventListeners=[],this.onDestroyed&&this.onDestroyed(this.internalState)}}function dt(s,t){if(t!=null&&t.get(s.tagName)&&s.setAttribute(ht,""),s instanceof Text&&s.textContent&&s.textContent.length!==0){const e=s.textContent.replaceAll(Q,(n,i)=>h+"{"+C(i)+"}").replaceAll(y,(n,i)=>h+C(i));s.textContent=e}else if(s.hasAttributes())for(const e of Array.from(s.attributes))e.name===h+"model"?e.value=C(e.value.replace(h,"")):e.name.startsWith(v)?e.value=C(e.value).replaceAll(y,(n,i)=>h+C(i)):e.value=e.value.replaceAll(y,(n,i)=>h+C(i));s.hasChildNodes()&&ee(s.childNodes,t)}function ee(s,t){for(let e=0;e<s.length;e++){const n=s[e];dt(n,t)}}function C(s){return s.startsWith(p)?s.substring(p.length):p+s}const ft="data-elaine-c-";class ne{constructor(t,e,n=[],i=[],o=void 0,r=void 0,u){a(this,"name");a(this,"template");a(this,"props",[]);a(this,"slots",[]);a(this,"setup");a(this,"css");a(this,"components");if(this.name=t,this.template=e.cloneNode(!0),this.props=n,this.slots=i,this.setup=o,this.components=u,r){const l=ft+t.toLowerCase();this.css=r.replaceAll(/.*\{/g,c=>`${c.substring(0,c.length-1).trim()}[${l}] {`).replace(/  |\r\n|\n|\r/gm,""),this.addAttributeToAllElements(this.template,l)}}addAttributeToAllElements(t,e){if(t.setAttribute(e,""),t.children.length>0)for(const n of Array.from(t.children))this.addAttributeToAllElements(n,e)}gatherAllComponents(){if(!this.components)return[this];const t=[this];for(const e of this.components)for(const n of e.gatherAllComponents())t.push(n);return t}toInstance(t,e=void 0){return new I(x.COMPONENT,t,this.template,e,this.props,this.slots,this.setup,this.components)}}class se{constructor(t,e){a(this,"routes");a(this,"currentPath");a(this,"currentRoute");this.routes=t,this.currentPath=mt(window.location.hash),this.currentRoute=X(()=>{const n=this.currentPath.value.slice(1)||"/";return this.routes.find(i=>i.path===n)||{path:"/404",component:e}},this.currentPath),window.addEventListener("hashchange",()=>{this.currentPath.value=window.location.hash})}changeRoute(t){window.location.hash=t}}function ie(s,t=void 0){t||(t=Z({name:"DefaultNotFound",template:"<div>Route not found.</div>"}));const e=new se(s,t);return{router:e,routerComponent:Z({name:"router-view",template:"<!-- router -->",setup:n=>{const i=k("<span></span>"),o=new I(x.COMPONENT,i,i,void 0,[],[],()=>({state:{currentRouteProps:X(()=>e.currentRoute.value.props,e.currentRoute)}}));o.setupIfNeeded();let r;function u(){r==null||r.unmount(),r==null||r.destroy();const l=e.currentRoute.value,c=l.props?Object.keys(l.props).map(f=>`${f}="@@currentRouteProps.${f}"`).join(" "):"",d=k(`<${l.component.name} ${c}></${l.component.name}>`);r=l.component.toInstance(d,o),r.appendMount(n.element)}return z(u,e.currentRoute),u(),{onUnmounted:()=>{r==null||r.unmount()},beforeDestroyed:()=>{r==null||r.destroy()}}},components:s.map(n=>n.component).concat([t])})}}Object.defineProperty(Object.prototype,"setValueForKey",{value:function(s,t){this[t]=s}}),Object.defineProperty(Object.prototype,"setValueForKeyPath",{value:function(s,t){if(s==null)return;if(s.indexOf(".")===-1){this.setValueForKey(t,s);return}const e=s.split("."),n=e.shift(),i=e.join(".");n&&this[n].setValueForKeyPath(i,t)}}),Object.defineProperty(Object.prototype,"getValueForKey",{value:function(s){return this[s]}}),Object.defineProperty(Object.prototype,"getValueForKeyPath",{value:function(s){if(s!=null){if(s.indexOf(".")===-1)return this.getValueForKey(s);var t=s.split("."),e=t.shift(),n=t.join(".");if(e)return this[e].getValueForKeyPath(n)}}});function oe(s,t=void 0){const e=new I(x.SETUP,s,s,void 0,[],[],()=>t,t==null?void 0:t.components);return e.mount(),console.log(e),e.internalState}function mt(s){return new L(s)}function re(s){return new q(s)}function z(s,...t){const e=new ot(s,...t);for(const n of t)n.subscribe(e)}function X(s,...t){const e=new N(s,t);for(const n of t)n==null||n.subscribe(e);return e}function k(s){const t=document.createElement("template");return s=s.trim(),t.innerHTML=s,t.content.firstChild}function Z(s){const t=s.name.toUpperCase(),e=typeof s.template=="string"?k(s.template):s.template;return new ne(t,e,s.props,s.slots,s.setup,s.css,s.components)}function ae(){return M}function ue(){return U.value}function le(s){Xt(s)}function ce(s,t=void 0){return ie(s,t)}m.component=Z,m.computed=X,m.createRouter=ce,m.eventHub=ae,m.getStore=ue,m.inert=re,m.setup=oe,m.state=mt,m.templateToElement=k,m.watch=z,m.withOptions=le,Object.defineProperties(m,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
